<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Panasonic Project Management Dashboard</title>
    <style>
        :root {
            --primary-color: #005ab2; /* Màu xanh Panasonic */
            --bg-color: #f4f7f6;
            --text-color: #333;
        }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; display: flex; height: 100vh; background: var(--bg-color); }

        /* Sidebar bên trái: Danh sách dự án */
        .sidebar-left { width: 350px; background: white; border-right: 1px solid #ddd; display: flex; flex-direction: column; }
        .search-box { padding: 15px; border-bottom: 1px solid #eee; }
        .search-box input { width: 90%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        
        .project-list { flex-grow: 1; overflow-y: auto; }
        .project-item { padding: 15px; border-bottom: 1px solid #f9f9f9; cursor: pointer; transition: 0.2s; }
        .project-item:hover { background: #eef6ff; }
        .project-item h4 { margin: 0 0 5px 0; color: var(--primary-color); }
        .project-item p { margin: 2px 0; font-size: 13px; color: #666; }

        /* Vùng trung tâm: Bản đồ */
        .main-map { flex-grow: 1; position: relative; background: #e0ddd8; display: flex; align-items: center; justify-content: center; }
        .map-placeholder { text-align: center; color: #888; }

        /* Sidebar bên phải: Báo cáo & Lọc */
        .sidebar-right { width: 300px; background: white; border-left: 1px solid #ddd; padding: 20px; }
        .filter-section, .report-section { margin-bottom: 30px; }
        h3 { border-left: 4px solid var(--primary-color); padding-left: 10px; font-size: 18px; }
        
        select { width: 100%; padding: 10px; margin-top: 10px; border-radius: 4px; border: 1px solid #ddd; }

        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #ddd; }
        .stat-card.active { border-left-color: #28a745; }
        .stat-card b { font-size: 20px; display: block; }
        
        .tag { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 11px; color: white; margin-top: 5px; }
        .tag-dang-xd { background: #dc3545; }
        .tag-dang-ht { background: #28a745; }
        .tag-da-xong { background: #007bff; }
        .tag-sap-tk { background: #fd7e14; }
    </style>
</head>
<body>

    <div class="sidebar-left">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Tìm tên dự án, chủ đầu tư..." onkeyup="handleSearch()">
        </div>
        <div id="projectList" class="project-list">
            </div>
    </div>

    <div class="main-map" id="map">
        <div class="map-placeholder">
            <img src="https://upload.wikimedia.org/wikipedia/commons/e/ed/Map_placeholder.png" width="100" style="opacity: 0.3;"><br>
            BẢN ĐỒ DỰ ÁN MIỀN BẮC (BÁN KÍNH 30KM)<br>
            <small>(Tích hợp Google Maps/Leaflet tại đây)</small>
        </div>
    </div>

    <div class="sidebar-right">
        <div class="filter-section">
            <h3>BỘ LỌC CHIẾN LƯỢC</h3>
            <label>Tình trạng thi công:</label>
            <select id="filterStatus" onchange="applyFilters()">
                <option value="all">-- Tất cả tình trạng --</option>
                </select>
        </div>

        <div class="report-section">
            <h3>BÁO CÁO NHANH</h3>
            <div id="statsSummary">
                </div>
        </div>
    </div>

    <script>
        // DỮ LIỆU DỰ ÁN (Đã cập nhật các dự án mới nhất của bạn)
        const projects = [
            {id: 1, ten: "Ruby City CT3", cdt: "Thăng Long VN", tinhTrang: "Đã xong", khoangCach: "0.5 km", soCan: 1120, dienTich: "0.5 ha"},
            {id: 2, ten: "Ruby Park (Mới)", cdt: "Thăng Long VN", tinhTrang: "Đang HT", khoangCach: "0.6 km", soCan: 400, dienTich: "1.2 ha"},
            {id: 51, ten: "Vinhomes Cổ Loa", cdt: "Vingroup", tinhTrang: "Sắp triển khai", khoangCach: "12.5 km", soCan: 15000, dienTich: "385 ha"},
            {id: 63, ten: "Him Lam Vĩnh Tuy", cdt: "Him Lam", tinhTrang: "Đang XD", khoangCach: "5.5 km", soCan: 1000, dienTich: "16.2 ha"},
            {id: 102, ten: "Lumi Hanoi", cdt: "CapitaLand", tinhTrang: "Đang XD", khoangCach: "28.0 km", soCan: 3950, dienTich: "5.6 ha"},
            {id: 105, ten: "Masteri Lumiere EverGreen", cdt: "Masterise", tinhTrang: "Đang HT", khoangCach: "28.3 km", soCan: 2294, dienTich: "1.7 ha"},
            // ... Bạn có thể copy thêm 170 dự án vào đây
        ];

        // 1. KHỞI TẠO BỘ LỌC ĐỘNG (Tự quét tình trạng để tạo Select Option)
        function initFilters() {
            const select = document.getElementById('filterStatus');
            const statuses = [...new Set(projects.map(p => p.tinhTrang))];
            
            statuses.forEach(status => {
                const opt = document.createElement('option');
                opt.value = status;
                opt.innerHTML = status;
                select.appendChild(opt);
            });
        }

        // 2. HIỂN THỊ DANH SÁCH DỰ ÁN
        function renderProjects(data) {
            const list = document.getElementById('projectList');
            list.innerHTML = '';
            
            data.forEach(p => {
                const statusClass = p.tinhTrang.toLowerCase().replace(/\s/g, '-');
                list.innerHTML += `
                    <div class="project-item">
                        <h4>${p.ten}</h4>
                        <p><b>CĐT:</b> ${p.cdt} | <b>Cách kho:</b> ${p.khoangCach}</p>
                        <p><b>Quy mô:</b> ${p.soCan} căn | ${p.dienTich}</p>
                        <span class="tag tag-${statusClass}">${p.tinhTrang}</span>
                    </div>
                `;
            });
            updateStats(data);
        }

        // 3. XỬ LÝ LỌC
        function applyFilters() {
            const status = document.getElementById('filterStatus').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = projects.filter(p => {
                const matchStatus = (status === 'all' || p.tinhTrang === status);
                const matchSearch = p.ten.toLowerCase().includes(searchTerm) || p.cdt.toLowerCase().includes(searchTerm);
                return matchStatus && matchSearch;
            });

            renderProjects(filtered);
        }

        // 4. TÌM KIẾM NHANH
        function handleSearch() {
            applyFilters();
        }

        // 5. CẬP NHẬT THỐNG KÊ (Bên phải)
        function updateStats(data) {
            const statsContainer = document.getElementById('statsSummary');
            const summary = data.reduce((acc, curr) => {
                acc[curr.tinhTrang] = (acc[curr.tinhTrang] || 0) + 1;
                return acc;
            }, {});

            statsContainer.innerHTML = '';
            for (const [key, value] of Object.entries(summary)) {
                statsContainer.innerHTML += `
                    <div class="stat-card">
                        ${key}
                        <b>${value} dự án</b>
                    </div>
                `;
            }
        }

        // CHẠY KHI TRANG LOAD XONG
        initFilters();
        renderProjects(projects);

    </script>
</body>
</html>
